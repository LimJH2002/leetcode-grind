SELECT V.CUSTOMER_ID, COUNT(*) AS count_no_trans
FROM VISITS V
LEFT JOIN TRANSACTIONS T
ON V.VISIT_ID = T.VISIT_ID
WHERE TRANSACTION_ID IS NULL
GROUP BY V.CUSTOMER_ID